<nav-bar></nav-bar>

<header class="Hero TagHero TagHero--colored" style="background:{{viewPost.post.id | bgColor}}; color:{{viewPost.post.id | textColor}};">
  <div class="container">
    <div class="containerNarrow">
      <h4 class="item-tags" align="center">
        <tag-capsules id2tag="$root.id2courseTag" ids="$root.id2course[viewPost.post.courseId].courseTagIds"></tag-capsules>
        <span class="TagLabel-text">{{$root.id2course[viewPost.post.courseId].name}}</span>  
      </h4>
      <h2 class="Hero-title" align="center" style="color:{{viewPost.post.id | textColor}};">
        {{viewPost.post.title}}
      </h2>
      <h4 class="item-tags" align="center">
        <tag-capsules id2tag="$root.id2postTag" ids="viewPost.post.postTagIds"></tag-capsules>
      </h4>
    </div>
  </div>
</header>

<div class="container">

  <nav class="DiscussionPage-nav">
    <ul>
      <li class="item-controls">
        <div class="ButtonGroup Dropdown dropdown App-primaryControl Dropdown--split itemCount1">
          <button class=" SplitDropdown-button Button Button--primary hasIcon" type="button" ng-click="viewPost.scrollTo('reply')">
            <i class="icon fa fa-fw fa-reply"></i>
            <span class="Button-label">Reply</span>
          </button>
        </div>
        <div class="ButtonGroup Dropdown dropdown App-primaryControl Dropdown--split itemCount1" ng-show="!$root.favorites[viewPost.post.id]">
          <button class=" SplitDropdown-button Button Button--primary hasIcon" type="button" ng-click="viewPost.clickLike()">
            <i class="icon fa fa-fw fa-heart-o"></i>
            <span class="Button-label">Like</span>
          </button>
        </div>
        <div class="ButtonGroup Dropdown dropdown App-primaryControl Dropdown--split itemCount1" ng-show="$root.favorites[viewPost.post.id]">
          <button class=" SplitDropdown-button Button Button--primary hasIcon" type="button" ng-click="viewPost.clickUnlike()">
            <i class="icon fa fa-fw fa-heart "></i>
            <span class="Button-label">Unlike</span>
          </button>
        </div>
      </li>
      <!--<li class="item-scrubber">
        <div class="PostStreamScrubber Dropdown App-titleControl">
          <button class="Button Dropdown-toggle" data-toggle="dropdown">
            <span class="Scrubber-index">1</span> of <span class="Scrubber-count">21</span> posts <i class="icon fa fa-fw fa-sort "></i>
          </button>
          <div class="Dropdown-menu dropdown-menu">
            <div class="Scrubber">
              <a class="Scrubber-first">
                <i class="icon fa fa-fw fa-angle-double-up "></i>
                Original Post
              </a>
              <div class="Scrubber-scrollbar" style="max-height: 405px; cursor: pointer; user-select: none;">
                <div class="Scrubber-before" style="height: 0%;"></div>
                <div class="Scrubber-handle" style="cursor: move; height: 16.6667%;">
                  <div class="Scrubber-bar"></div>
                  <div class="Scrubber-info">
                    <strong>
                      <span class="Scrubber-index">1</span> of <span class="Scrubber-count">21</span> posts
                    </strong>
                    <span class="Scrubber-description">June 2016</span>
                  </div>
                </div>
                <div class="Scrubber-after" style="height: 83.3333%;"></div>
                <div class="Scrubber-unread" style="top: 100%; height: 0%;"> unread</div>
              </div>
              <a class="Scrubber-last">
                <i class="icon fa fa-fw fa-angle-double-down "></i> Now
              </a>
            </div>
          </div>
        </div>
      </li>-->
    </ul>
  </nav>

  <div class="DiscussionPage-stream">
    <div class="PostStream">
      <div class="PostStream-item" data-index="0" data-type="comment" style="display: block;" id='post'>
        <article class="Post CommentPost Post--edited">
          <div>
            <header class="Post-header">
              <ul>
                <li class="item-user">
                  <div class="PostUser">
                    <h3>
                      <a href="#!/user-view/{{viewPost.post.user.id}}">
                        <span class="Avatar PostUser-avatar" style="background: {{viewPost.post.user.name | bgColor}}; color:{{viewPost.post.user.name | textColor}};">
                          {{viewPost.firstCharUpperCase(viewPost.post.user.name)}}
                        </span>
                        <span class="username">{{viewPost.post.user.name}}</span>
                      </a>
                    </h3>
                    <ul class="PostUser-badges badges"></ul>
                  </div>
                </li>
                <li class="item-meta">
                  <div class="Dropdown PostMeta">
                    <a class="Dropdown-toggle" data-toggle="dropdown">
                      <time pubdate="true" datetime="2016-10-21T21:31:40+08:00" title="{{viewPost.post.createdAt | date}}" data-humantime="true">
                        {{viewPost.post.createdAt | date}}
                      </time>
                    </a>
                    <!--<div class="Dropdown-menu dropdown-menu">
                      <span class="PostMeta-number">Post #1</span>
                      <time pubdate="true" datetime="2016-10-21T21:31:40+08:00">Friday, October 21, 2016 9:31 PM</time>
                      <input class="FormControl PostMeta-permalink">
                    </div>-->
                  </div>
                </li>
                <li class="item-edited">
                  <span class="PostEdited" title="" data-original-title="ftiasch edited 2 days ago">
                    <i class="icon fa fa-fw fa-pencil "></i>
                  </span>
                </li>
              </ul>
            </header>
            <div class="Post-body">
              <p style="color: #FDD835;">
                <i class="icon fa fa-star" ng-repeat="i in viewPost.post.stars | range"></i><i class="icon fa fa-star-o" ng-repeat="i in (5 - viewPost.post.stars) | range"></i>
              </p>
              <p ng-bind-html="viewPost.renderHtml(viewPost.post.comment)">
              </p>
            </div>
            <!--<aside class="Post-actions">
              <ul>
                <li class="item-like">
                  <button class="Button Button--link" type="button">
                    <span class="Button-label">Like</span>
                  </button>
                </li>
                <li class="item-reply">
                  <button class="Button Button--link" type="button">
                    <span class="Button-label">Reply</span>
                  </button>
                </li>
              </ul>
            </aside>-->
            <footer class="Post-footer">
              <ul></ul>
            </footer>
          </div>
        </article>
      </div>

      <!-- Replies -->
      <div class="PostStream-item" data-index="1" data-type="comment" style="display: block;" ng-repeat="reply in viewPost.replies" id='reply'>
        <article class="Post CommentPost">
          <div>
            <header class="Post-header">
              <ul>
                <li class="item-user">
                  <div class="PostUser">
                    <h3>
                      <!--<a href="">
                        <img class="Avatar PostUser-avatar" src="https://async.icpc-camp.org/assets/avatars/2878dfb7b5a544d5b85051494be38948.png">
                        <span class="username">zimpha</span>
                      </a>-->
                      <a href="#!/user-view/{{reply.user.id}}">
                        <span class="Avatar PostUser-avatar" style="background: {{reply.user.name | bgColor}}; color:{{reply.user.name | textColor}};">
                          {{viewPost.firstCharUpperCase(reply.user.name)}}
                        </span>
                        <span class="username">{{reply.user.name}}</span>
                      </a>
                    </h3>
                    <ul class="PostUser-badges badges">
                      <!--<li class="item-group4">
                        <span class="Badge Badge--group--Mod " title="" style="background-color: rgb(128, 52, 158);" data-original-title="Mod">
                          <i class="icon fa fa-fw fa-bolt Badge-icon"></i>
                        </span>
                      </li>-->
                    </ul>
                  </div>
                </li>
                <li class="item-meta">
                  <div class="Dropdown PostMeta">
                    <a class="Dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                      <time pubdate="true" datetime="{{reply.updatedAt}}" title="{{reply.updatedAt | date}}" data-humantime="true">{{reply.updatedAt | date}}</time>
                    </a>
                    <!--<div class="Dropdown-menu dropdown-menu">
                      <span class="PostMeta-number">Post #2</span>
                      <time pubdate="true" datetime="{{reply.updatedAt}}">
                        {{reply.updatedAt | date}}
                      </time>
                      <input class="FormControl PostMeta-permalink">
                    </div>-->
                  </div>
                </li>
              </ul>
            </header>
            <div class="Post-body">
              <p ng-bind-html="viewPost.renderHtml(reply.content)"></p>
            </div>
            <!--<aside class="Post-actions">
              <ul>
                <li class="item-like">
                  <button class="Button Button--link" type="button">
                    <span class="Button-label">Like</span>
                  </button>
                </li>
                <li class="item-reply">
                  <button class="Button Button--link" type="button">
                    <span class="Button-label">Reply</span>
                  </button>
                </li>
              </ul>
            </aside>-->
            <footer class="Post-footer">
              <ul></ul>
            </footer>
          </div>
          <ul class="Dropdown-menu PostMention-preview fade"></ul>
        </article>
      </div>
      
      <div class="PostStream-item" id="reply">
        <article class="Post">
          <header class="Post-header">
            <span class="Avatar PostUser-avatar" style="background: {{$root.user.name | bgColor}}; color:{{$root.user.name | textColor}};">
              {{viewPost.firstCharUpperCase($root.user.name)}}
            </span>
            <h5>
              <i class="icon fa fa-fw fa-reply "></i>
              <a ng-click="viewPost.scrollTo('post')">{{viewPost.post.title}}</a>
            </h5>
          </header>
          <div class="Post-body">
            <form ng-submit="viewPost.submitReply(viewPost.replyContent)">
              <div class="form-group">
                <text-angular id='comment' ng-model="viewPost.replyContent"></text-angular>
              </div>
              <div class="form-group" style="right: 0px;">
                <button type="submit" class="btn btn-default pull-right" >Reply</button>
              </div>
            </form>
          </div>
        </article>
      </div>

    </div>
  </div>
</div>
